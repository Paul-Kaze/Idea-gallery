[FRD]
# FRD: AI Baby Generator

## 1. 概述
AI Baby Generator 是一个基于 Web 的工具，允许用户通过上传参考图片（如父母照片或风格参考）并输入文本描述，生成预测的婴儿样貌图片。该工具采用左右分栏布局，左侧为配置与操作区，右侧为结果展示区。

## 2. 功能需求明细

| 一级功能 | 二级功能 | 三级功能 | 需求具体描述 | 优先级 |
|---|---|---|---|---|
| 导航与布局 | 页面布局 | 左右分栏 | 页面分为左侧操作区（控制台）和右侧预览区（结果展示）。 | P0 |
| 导航与布局 | 顶部导航 | 返回按钮 | 左侧顶部提供返回按钮，点击跳转至上一级 Tool 列表页面。 | P0 |
| 图像处理 | 图片上传 | 参考图上传 | 支持用户上传一张参考图片（如父母照片或风格图）。 | P0 |
| 图像处理 | 图片上传 | 格式校验 | 限制上传格式为 JPG, PNG, WEBP。 | P1 |
| 图像处理 | 图片上传 | 大小校验 | 限制单个文件大小不超过 5MB。 | P1 |
| 图像处理 | 图片上传 | 预览与删除 | 上传后显示缩略图，支持删除/替换当前图片。 | P1 |
| 文本处理 | 提示词输入 | 文本域 | 提供多行文本输入框，允许用户输入详细的画面描述。 | P0 |
| 文本处理 | 提示词输入 | 字符限制 | 限制最大字符数为 4000，右下角实时显示当前字符数（例如：547 / 4000）。 | P1 |
| 文本处理 | 提示词输入 | 错误提示 | 当字符数超过 4000 时，输入框边框变红，并禁用生成按钮。 | P1 |
| 计费与执行 | 积分计算 | 消耗提示 | 显示当前生成操作所需的积分（例如：10 Credits/次）。 | P0 |
| 计费与执行 | 积分计算 | 规则说明 | 积分数值旁显示 ⓘ 图标，悬停展示计费说明（Tooltip）。 | P1 |
| 计费与执行 | 生成操作 | 按钮状态 | 默认状态：高亮（红色/粉色背景）。<br>禁用状态：提示词为空或积分不足时置灰。<br>加载状态：点击后显示“生成中/Loading”，并禁用点击。 | P0 |
| 计费与执行 | 生成操作 | 余额校验 | 点击生成时，若余额不足，弹出提示框并引导充值。 | P0 |
| 结果展示 | 预览区 | 默认/空状态 | 未登录或无生成记录时，展示示例图片（Sample Image）。 | P0 |
| 结果展示 | 预览区 | 标题栏 | 顶部显示 "Sample Image" 或 "Generated Result"。 | P1 |
| 结果展示 | 预览区 | 加载状态 | 生成过程中，右侧区域显示加载动画或骨架屏。 | P0 |
| 结果展示 | 预览区 | 结果展示 | 生成成功后，展示最终生成的图片。 | P0 |
| 结果展示 | 预览区 | 图片操作 | 支持点击图片查看大图、下载图片。 | P1 |

## 3. 错误处理

| 错误代码 | 场景 | 系统响应 |
|---|---|---|
| ERR-001 | 图片上传格式不支持 | 提示“仅支持 JPG, PNG, WEBP 格式”。 |
| ERR-002 | 图片上传超过大小限制 | 提示“文件大小不能超过 5MB”。 |
| ERR-003 | 提示词为空点击生成 | 按钮置灰，若强制触发则提示“请输入提示词”。 |
| ERR-004 | 积分余额不足 | 弹窗提示“余额不足，请充值”，包含跳转链接。 |
| ERR-005 | 生成服务超时/失败 | 提示“生成失败，请稍后重试”，不扣除积分（或自动返还）。 |

## 4. API / 接口规范 (概要)

### 4.1 上传图片
- **Endpoint**: `POST /api/upload`
- **Input**: `FormData` (file)
- **Output**: `{ url: string, id: string }`

### 4.2 生成图片
- **Endpoint**: `POST /api/generate/baby`
- **Input**:
  ```json
  {
    "prompt": "string",
    "referenceImageId": "string (optional)"
  }
  ```
- **Output**:
  ```json
  {
    "taskId": "string",
    "status": "pending"
  }
  ```

### 4.3 查询任务状态
- **Endpoint**: `GET /api/tasks/{taskId}`
- **Output**:
  ```json
  {
    "status": "completed",
    "resultUrl": "string",
    "cost": number
  }
  ```

## 5. 质量门禁 (Quality Gates)

在提交代码或合并请求前，必须通过以下命令：

- `npm run build` (确保构建成功，包含类型检查)
- `npm run lint` (确保代码风格符合规范)
- `npm run test` (运行单元测试，确保无回归)
[/FRD]
